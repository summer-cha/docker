{
  "schemaVersion": 2,
  "services": [
    {
      "name": "wyze-mjpeg-proxy-wrapper",
      "image": "alpine:latest",
      "isMain": true,
      "internalPort": 8190,
      "command": [
        "sh",
        "-c",
        "apk add --no-cache curl ffmpeg && wget -O /usr/local/bin/wyze-mjpeg-proxy https://github.com/kamermans/wyze-mjpeg-proxy/releases/latest/download/wyze-mjpeg-proxy-linux-$(uname -m | sed 's/aarch64/arm64/; s/x86_64/amd64/') && chmod +x /usr/local/bin/wyze-mjpeg-proxy && printf 'verbosity: 0\\nport: 8190\\nstreams:\\n  - name: %s\\n    source: %s\\n    resolution: %s\\n    quality: %s\\n    framerate: %s\\n' \"$CAMERA_NAME\" \"$RTSP_SOURCE\" \"$RESOLUTION\" \"$QUALITY\" \"$FRAMERATE\" > /config.yaml && cat /config.yaml && exec wyze-mjpeg-proxy"
      ],
      "environment": [
        {
          "key": "CAMERA_NAME",
          "value": "${CAMERA_NAME}"
        },
        {
          "key": "RTSP_SOURCE",
          "value": "${RTSP_SOURCE}"
        },
        {
          "key": "RESOLUTION",
          "value": "${RESOLUTION}"
        },
        {
          "key": "QUALITY",
          "value": "${QUALITY}"
        },
        {
          "key": "FRAMERATE",
          "value": "${FRAMERATE}"
        }
      ]
    }
  ]
}
